<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>דשבורד פיננסי חכם</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f9fafb;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo } = React;
        // Simple icon component using Lucide with error handling
        const Icon = ({ name, className = "h-4 w-4" }) => {
          try {
            return React.createElement('i', { 
              'data-lucide': name, 
              className: className 
            });
          } catch (error) {
            // Fallback to a simple span if icon fails
            return React.createElement('span', { 
              className: className,
              style: { display: 'inline-block', width: '1rem', height: '1rem' }
            }, '•');
          }
        };

        const FinancialDashboard = () => {
          const [activeTab, setActiveTab] = useState('dashboard');
          
          React.useEffect(() => {
            try {
              if (typeof lucide !== 'undefined' && lucide.createIcons) {
                lucide.createIcons();
              }
            } catch (error) {
              console.warn('Lucide icons could not be initialized:', error);
            }
          });
          // Load projects from localStorage or start with empty array
          const [projects, setProjects] = useState(() => {
            const savedProjects = localStorage.getItem('financialDashboardProjects');
            return savedProjects ? JSON.parse(savedProjects) : [];
          });
          
          // Save projects to localStorage whenever projects change
          React.useEffect(() => {
            localStorage.setItem('financialDashboardProjects', JSON.stringify(projects));
          }, [projects]);

          const [selectedProject, setSelectedProject] = useState('all');
          const [isEditing, setIsEditing] = useState(null);
          const [newProject, setNewProject] = useState({
            orderDate: '',
            clientName: '',
            orderDetails: '',
            transactionAmount: '',
            vatPercent: 17,
            projectReceipts: '',
            projectNotes: ''
          });
          const [showAddForm, setShowAddForm] = useState(false);
          const [searchTerm, setSearchTerm] = useState('');
          const [isImporting, setIsImporting] = useState(false);
          const [importError, setImportError] = useState('');
          
          // File input ref for import
          const fileInputRef = React.useRef(null);

          // חישוב KPI
          const dashboardData = useMemo(() => {
            const filteredProjects = selectedProject === 'all' 
              ? projects 
              : projects.filter(p => p.id === parseInt(selectedProject));

            const totalTransactionAmount = filteredProjects.reduce((sum, p) => sum + p.transactionAmount, 0);
            const totalVatAmount = filteredProjects.reduce((sum, p) => sum + (p.transactionAmount * p.vatPercent / 100), 0);
            const totalPayment = filteredProjects.reduce((sum, p) => sum + p.totalPayment, 0);
            const totalReceipts = filteredProjects.reduce((sum, p) => sum + p.projectReceipts, 0);
            const totalRemaining = filteredProjects.reduce((sum, p) => sum + p.remainingBalance, 0);

            const completionRate = totalPayment > 0 ? (totalReceipts / totalPayment) * 100 : 0;
            const completedProjects = filteredProjects.filter(p => p.remainingBalance === 0).length;
            const inProgressProjects = filteredProjects.filter(p => p.remainingBalance > 0).length;

            return {
              totalTransactionAmount,
              totalVatAmount,
              totalPayment,
              totalReceipts,
              totalRemaining,
              completionRate,
              completedProjects,
              inProgressProjects,
              totalProjects: filteredProjects.length
            };
          }, [projects, selectedProject]);

          const handleAddProject = () => {
            // Fix: Add validation and safe parsing
            const transactionAmount = parseFloat(newProject.transactionAmount) || 0;
            const vatPercent = parseFloat(newProject.vatPercent) || 17;
            const projectReceipts = parseFloat(newProject.projectReceipts) || 0;
            
            if (!newProject.clientName || !newProject.orderDetails || transactionAmount <= 0) {
              alert('אנא מלא את כל השדות הנדרשים');
              return;
            }

            const totalPayment = transactionAmount * (1 + vatPercent / 100);
            const remainingBalance = totalPayment - projectReceipts;

            const project = {
              id: Date.now(),
              ...newProject,
              transactionAmount,
              vatPercent,
              totalPayment,
              projectReceipts,
              remainingBalance
            };

            setProjects([...projects, project]);
            setNewProject({
              orderDate: '',
              clientName: '',
              orderDetails: '',
              transactionAmount: '',
              vatPercent: 17,
              projectReceipts: '',
              projectNotes: ''
            });
            setShowAddForm(false);
          };

          const handleEditProject = (id, updatedProject) => {
            // Fix: Add safe parsing
            const transactionAmount = parseFloat(updatedProject.transactionAmount) || 0;
            const vatPercent = parseFloat(updatedProject.vatPercent) || 17;
            const projectReceipts = parseFloat(updatedProject.projectReceipts) || 0;
            
            const totalPayment = transactionAmount * (1 + vatPercent / 100);
            const remainingBalance = totalPayment - projectReceipts;

            setProjects(projects.map(p => 
              p.id === id 
                ? { ...updatedProject, id, transactionAmount, vatPercent, projectReceipts, totalPayment, remainingBalance }
                : p
            ));
            setIsEditing(null);
          };

          const handleDeleteProject = (id) => {
            setProjects(projects.filter(p => p.id !== id));
          };
          
          // Import projects from JSON file
          const handleImportProjects = (event) => {
            const file = event.target.files[0];
            if (!file) return;
            
            setIsImporting(true);
            setImportError('');
            
            const reader = new FileReader();
            reader.onload = (e) => {
              try {
                const importedData = JSON.parse(e.target.result);
                
                // Validate imported data
                if (!Array.isArray(importedData)) {
                  throw new Error('הקובץ חייב להכיל מערך של פרויקטים');
                }
                
                // Validate each project has required fields
                const validatedProjects = importedData.map((project, index) => {
                  if (!project.clientName || !project.orderDetails || typeof project.transactionAmount !== 'number') {
                    throw new Error(`פרויקט מספר ${index + 1} חסר שדות חובה`);
                  }
                  
                  // Ensure all numeric fields are properly calculated
                  const transactionAmount = parseFloat(project.transactionAmount) || 0;
                  const vatPercent = parseFloat(project.vatPercent) || 17;
                  const projectReceipts = parseFloat(project.projectReceipts) || 0;
                  const totalPayment = transactionAmount * (1 + vatPercent / 100);
                  const remainingBalance = totalPayment - projectReceipts;
                  
                  return {
                    id: project.id || Date.now() + Math.random(),
                    orderDate: project.orderDate || new Date().toISOString().split('T')[0],
                    clientName: project.clientName,
                    orderDetails: project.orderDetails,
                    transactionAmount,
                    vatPercent,
                    totalPayment,
                    projectReceipts,
                    remainingBalance,
                    projectNotes: project.projectNotes || ''
                  };
                });
                
                setProjects(validatedProjects);
                alert(`הועלו בהצלחה ${validatedProjects.length} פרויקטים`);
                
              } catch (error) {
                setImportError(error.message);
                alert('שגיאה ביבוא הקובץ: ' + error.message);
              } finally {
                setIsImporting(false);
                if (fileInputRef.current) {
                  fileInputRef.current.value = '';
                }
              }
            };
            
            reader.readAsText(file);
          };
          
          // Export projects to JSON file
          const handleExportProjects = () => {
            if (projects.length === 0) {
              alert('אין פרויקטים לייצוא');
              return;
            }
            
            const dataStr = JSON.stringify(projects, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `financial-dashboard-projects-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            URL.revokeObjectURL(url);
          };

          const filteredProjectsForTable = projects.filter(project =>
            project.clientName.toLowerCase().includes(searchTerm.toLowerCase()) ||
            project.orderDetails.toLowerCase().includes(searchTerm.toLowerCase())
          );

          const formatCurrency = (amount) => {
            return new Intl.NumberFormat('he-IL', {
              style: 'currency',
              currency: 'ILS',
              currencyDisplay: 'symbol'
            }).format(amount).replace('IL', '');
          };

          const KPICard = ({ title, value, iconName, color, subtitle }) => (
            React.createElement('div', {
              className: "bg-white rounded-lg shadow-lg p-6 border-r-4",
              style: { borderColor: color }
            },
              React.createElement('div', { className: "flex items-center justify-between" },
                React.createElement('div', null,
                  React.createElement('p', { className: "text-gray-600 text-sm font-medium" }, title),
                  React.createElement('p', { className: "text-2xl font-bold text-gray-900" }, value),
                  subtitle && React.createElement('p', { className: "text-sm text-gray-500 mt-1" }, subtitle)
                ),
                React.createElement(Icon, { name: iconName, className: "h-8 w-8", style: { color } })
              )
            )
          );

          const ProjectRow = ({ project, isEditing, onEdit, onSave, onCancel, onDelete, formatCurrency }) => {
            const [editData, setEditData] = useState(project);

            const handleSave = () => {
              onSave(editData);
            };

            if (isEditing) {
              return React.createElement('tr', { className: "bg-yellow-50" },
                React.createElement('td', { className: "px-6 py-4" },
                  React.createElement('input', {
                    type: "date",
                    value: editData.orderDate,
                    onChange: (e) => setEditData({...editData, orderDate: e.target.value}),
                    className: "w-full border border-gray-300 rounded px-2 py-1"
                  })
                ),
                React.createElement('td', { className: "px-6 py-4" },
                  React.createElement('input', {
                    type: "text",
                    value: editData.clientName,
                    onChange: (e) => setEditData({...editData, clientName: e.target.value}),
                    className: "w-full border border-gray-300 rounded px-2 py-1 text-right"
                  })
                ),
                React.createElement('td', { className: "px-6 py-4" },
                  React.createElement('input', {
                    type: "text",
                    value: editData.orderDetails,
                    onChange: (e) => setEditData({...editData, orderDetails: e.target.value}),
                    className: "w-full border border-gray-300 rounded px-2 py-1 text-right"
                  })
                ),
                React.createElement('td', { className: "px-6 py-4" },
                  React.createElement('input', {
                    type: "number",
                    value: editData.transactionAmount,
                    onChange: (e) => setEditData({...editData, transactionAmount: e.target.value}),
                    className: "w-full border border-gray-300 rounded px-2 py-1"
                  })
                ),
                React.createElement('td', { className: "px-6 py-4" },
                  React.createElement('input', {
                    type: "number",
                    value: editData.vatPercent,
                    onChange: (e) => setEditData({...editData, vatPercent: e.target.value}),
                    className: "w-full border border-gray-300 rounded px-2 py-1"
                  })
                ),
                React.createElement('td', { className: "px-6 py-4 text-sm text-gray-900" },
                  formatCurrency((parseFloat(editData.transactionAmount) || 0) * (1 + (parseFloat(editData.vatPercent) || 17) / 100))
                ),
                React.createElement('td', { className: "px-6 py-4" },
                  React.createElement('input', {
                    type: "number",
                    value: editData.projectReceipts,
                    onChange: (e) => setEditData({...editData, projectReceipts: e.target.value}),
                    className: "w-full border border-gray-300 rounded px-2 py-1"
                  })
                ),
                React.createElement('td', { className: "px-6 py-4 text-sm text-gray-900" },
                  formatCurrency(((parseFloat(editData.transactionAmount) || 0) * (1 + (parseFloat(editData.vatPercent) || 17) / 100)) - (parseFloat(editData.projectReceipts) || 0))
                ),
                React.createElement('td', { className: "px-6 py-4" },
                  React.createElement('input', {
                    type: "text",
                    value: editData.projectNotes,
                    onChange: (e) => setEditData({...editData, projectNotes: e.target.value}),
                    className: "w-full border border-gray-300 rounded px-2 py-1 text-right"
                  })
                ),
                React.createElement('td', { className: "px-6 py-4" },
                  React.createElement('div', { className: "flex space-x-reverse space-x-2" },
                    React.createElement('button', {
                      onClick: handleSave,
                      className: "text-green-600 hover:text-green-900"
                    }, React.createElement(Icon, { name: "save", className: "h-4 w-4" })),
                    React.createElement('button', {
                      onClick: onCancel,
                      className: "text-gray-600 hover:text-gray-900"
                    }, React.createElement(Icon, { name: "x", className: "h-4 w-4" }))
                  )
                )
              );
            }

            return React.createElement('tr', { className: "hover:bg-gray-50" },
              React.createElement('td', { className: "px-6 py-4 whitespace-nowrap text-sm text-gray-900" }, project.orderDate),
              React.createElement('td', { className: "px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right" }, project.clientName),
              React.createElement('td', { className: "px-6 py-4 text-sm text-gray-900 text-right max-w-xs truncate" }, project.orderDetails),
              React.createElement('td', { className: "px-6 py-4 whitespace-nowrap text-sm text-gray-900" }, formatCurrency(project.transactionAmount)),
              React.createElement('td', { className: "px-6 py-4 whitespace-nowrap text-sm text-gray-900" }, project.vatPercent + '%'),
              React.createElement('td', { className: "px-6 py-4 whitespace-nowrap text-sm text-gray-900 font-medium" }, formatCurrency(project.totalPayment)),
              React.createElement('td', { className: "px-6 py-4 whitespace-nowrap text-sm text-gray-900" }, formatCurrency(project.projectReceipts)),
              React.createElement('td', { 
                className: `px-6 py-4 whitespace-nowrap text-sm font-medium ${project.remainingBalance === 0 ? 'text-green-600' : 'text-red-600'}`
              }, formatCurrency(project.remainingBalance)),
              React.createElement('td', { className: "px-6 py-4 text-sm text-gray-900 text-right max-w-xs truncate" }, project.projectNotes),
              React.createElement('td', { className: "px-6 py-4 whitespace-nowrap" },
                React.createElement('div', { className: "flex space-x-reverse space-x-2" },
                  React.createElement('button', {
                    onClick: onEdit,
                    className: "text-blue-600 hover:text-blue-900"
                  }, React.createElement(Icon, { name: "edit-2", className: "h-4 w-4" })),
                  React.createElement('button', {
                    onClick: onDelete,
                    className: "text-red-600 hover:text-red-900"
                  }, React.createElement(Icon, { name: "trash-2", className: "h-4 w-4" }))
                )
              )
            );
          };

          return React.createElement('div', { className: "min-h-screen bg-gray-50", dir: "rtl" },
            // Header
            React.createElement('div', { className: "bg-white shadow-sm border-b" },
              React.createElement('div', { className: "max-w-7xl mx-auto px-4" },
                React.createElement('div', { className: "flex justify-between items-center py-4" },
                  React.createElement('h1', { className: "text-2xl font-bold text-gray-900" }, 'דשבורד פיננסי חכם'),
                  React.createElement('div', { className: "flex space-x-reverse space-x-4" },
                    React.createElement('button', {
                      onClick: () => setActiveTab('dashboard'),
                      className: `px-4 py-2 rounded-lg font-medium ${
                        activeTab === 'dashboard' 
                          ? 'bg-blue-600 text-white' 
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`
                    }, 'דשבורד'),
                    React.createElement('button', {
                      onClick: () => setActiveTab('database'),
                      className: `px-4 py-2 rounded-lg font-medium ${
                        activeTab === 'database' 
                          ? 'bg-blue-600 text-white' 
                          : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                      }`
                    }, 'מסד נתונים')
                  )
                )
              )
            ),

            React.createElement('div', { className: "max-w-7xl mx-auto px-4 py-6" },
              activeTab === 'dashboard' && React.createElement('div', { className: "space-y-6" },
                // Project Filter
                React.createElement('div', { className: "bg-white rounded-lg shadow p-4" },
                  React.createElement('div', { className: "flex items-center space-x-reverse space-x-4" },
                    React.createElement(Icon, { name: "filter", className: "h-5 w-5 text-gray-500" }),
                    React.createElement('label', { className: "text-sm font-medium text-gray-700" }, 'סינון לפי פרויקט:'),
                    React.createElement('select', {
                      value: selectedProject,
                      onChange: (e) => setSelectedProject(e.target.value),
                      className: "border border-gray-300 rounded-md px-3 py-2 bg-white text-right"
                    },
                      React.createElement('option', { value: "all" }, 'כל הפרויקטים'),
                      projects.map(project => 
                        React.createElement('option', { key: project.id, value: project.id },
                          project.clientName + ' - ' + project.orderDetails.substring(0, 30) + '...'
                        )
                      )
                    )
                  )
                ),

                // KPI Cards
                React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" },
                  React.createElement(KPICard, {
                    title: "סכום עסקאות",
                    value: formatCurrency(dashboardData.totalTransactionAmount),
                    iconName: "dollar-sign",
                    color: "#3B82F6"
                  }),
                  React.createElement(KPICard, {
                    title: "סכום מע״מ",
                    value: formatCurrency(dashboardData.totalVatAmount),
                    iconName: "receipt",
                    color: "#10B981"
                  }),
                  React.createElement(KPICard, {
                    title: "סה״כ לתשלום",
                    value: formatCurrency(dashboardData.totalPayment),
                    iconName: "trending-up",
                    color: "#8B5CF6"
                  }),
                  React.createElement(KPICard, {
                    title: "תקבולים לפרויקט",
                    value: formatCurrency(dashboardData.totalReceipts),
                    iconName: "check-circle",
                    color: "#06B6D4"
                  }),
                  React.createElement(KPICard, {
                    title: "יתרה לתשלום",
                    value: formatCurrency(dashboardData.totalRemaining),
                    iconName: "alert-circle",
                    color: "#EF4444"
                  }),
                  React.createElement(KPICard, {
                    title: "אחוז השלמה",
                    value: `${dashboardData.completionRate.toFixed(1)}%`,
                    iconName: "trending-up",
                    color: "#F59E0B",
                    subtitle: `${dashboardData.completedProjects} מתוך ${dashboardData.totalProjects} פרויקטים`
                  })
                ),

                // Project Status Overview
                React.createElement('div', { className: "bg-white rounded-lg shadow p-6" },
                  React.createElement('h3', { className: "text-lg font-semibold text-gray-900 mb-4" }, 'סטטוס פרויקטים'),
                  React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-4" },
                    React.createElement('div', { className: "text-center p-4 bg-green-50 rounded-lg" },
                      React.createElement('div', { className: "text-2xl font-bold text-green-600" }, dashboardData.completedProjects),
                      React.createElement('div', { className: "text-sm text-green-800" }, 'פרויקטים שהושלמו')
                    ),
                    React.createElement('div', { className: "text-center p-4 bg-yellow-50 rounded-lg" },
                      React.createElement('div', { className: "text-2xl font-bold text-yellow-600" }, dashboardData.inProgressProjects),
                      React.createElement('div', { className: "text-sm text-yellow-800" }, 'פרויקטים בתהליך')
                    ),
                    React.createElement('div', { className: "text-center p-4 bg-blue-50 rounded-lg" },
                      React.createElement('div', { className: "text-2xl font-bold text-blue-600" }, dashboardData.totalProjects),
                      React.createElement('div', { className: "text-sm text-blue-800" }, 'סה״כ פרויקטים')
                    )
                  )
                )
              ),

              activeTab === 'database' && React.createElement('div', { className: "space-y-6" },
                // Search, Import, Export, and Add
                React.createElement('div', { className: "bg-white rounded-lg shadow p-4" },
                  React.createElement('div', { className: "flex justify-between items-center mb-4" },
                    React.createElement('div', { className: "flex items-center space-x-reverse space-x-4" },
                      React.createElement(Icon, { name: "search", className: "h-5 w-5 text-gray-500" }),
                      React.createElement('input', {
                        type: "text",
                        placeholder: "חיפוש לפי שם לקוח או פירוט הזמנה...",
                        value: searchTerm,
                        onChange: (e) => setSearchTerm(e.target.value),
                        className: "border border-gray-300 rounded-md px-3 py-2 w-80 text-right"
                      })
                    ),
                    React.createElement('div', { className: "flex items-center space-x-reverse space-x-2" },
                      // Import button
                      React.createElement('button', {
                        onClick: () => fileInputRef.current.click(),
                        disabled: isImporting,
                        className: "bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center space-x-reverse space-x-2 disabled:opacity-50"
                      },
                        React.createElement(Icon, { name: "upload", className: "h-4 w-4" }),
                        React.createElement('span', null, isImporting ? 'מייבא...' : 'יבוא מקובץ')
                      ),
                      // Export button
                      React.createElement('button', {
                        onClick: handleExportProjects,
                        disabled: projects.length === 0,
                        className: "bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center space-x-reverse space-x-2 disabled:opacity-50"
                      },
                        React.createElement(Icon, { name: "download", className: "h-4 w-4" }),
                        React.createElement('span', null, 'ייצוא לקובץ')
                      ),
                      // Add project button
                      React.createElement('button', {
                        onClick: () => setShowAddForm(true),
                        className: "bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-reverse space-x-2"
                      },
                        React.createElement(Icon, { name: "plus", className: "h-4 w-4" }),
                        React.createElement('span', null, 'הוסף פרויקט')
                      )
                    )
                  ),
                  // Hidden file input for import
                  React.createElement('input', {
                    type: "file",
                    ref: fileInputRef,
                    accept: ".json",
                    onChange: handleImportProjects,
                    style: { display: 'none' }
                  })
                ),

                // Add Project Form
                showAddForm && React.createElement('div', { className: "bg-white rounded-lg shadow p-6" },
                  React.createElement('h3', { className: "text-lg font-semibold text-gray-900 mb-4" }, 'הוסף פרויקט חדש'),
                  React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4" },
                    React.createElement('input', {
                      type: "date",
                      placeholder: "תאריך הזמנה",
                      value: newProject.orderDate,
                      onChange: (e) => setNewProject({...newProject, orderDate: e.target.value}),
                      className: "border border-gray-300 rounded-md px-3 py-2"
                    }),
                    React.createElement('input', {
                      type: "text",
                      placeholder: "שם לקוח",
                      value: newProject.clientName,
                      onChange: (e) => setNewProject({...newProject, clientName: e.target.value}),
                      className: "border border-gray-300 rounded-md px-3 py-2 text-right"
                    }),
                    React.createElement('input', {
                      type: "text",
                      placeholder: "פירוט הזמנה",
                      value: newProject.orderDetails,
                      onChange: (e) => setNewProject({...newProject, orderDetails: e.target.value}),
                      className: "border border-gray-300 rounded-md px-3 py-2 text-right"
                    }),
                    React.createElement('input', {
                      type: "number",
                      placeholder: "סכום עסקה",
                      value: newProject.transactionAmount,
                      onChange: (e) => setNewProject({...newProject, transactionAmount: e.target.value}),
                      className: "border border-gray-300 rounded-md px-3 py-2"
                    }),
                    React.createElement('input', {
                      type: "number",
                      placeholder: "מע״מ (%)",
                      value: newProject.vatPercent,
                      onChange: (e) => setNewProject({...newProject, vatPercent: e.target.value}),
                      className: "border border-gray-300 rounded-md px-3 py-2"
                    }),
                    React.createElement('input', {
                      type: "number",
                      placeholder: "תקבולים לפרויקט",
                      value: newProject.projectReceipts,
                      onChange: (e) => setNewProject({...newProject, projectReceipts: e.target.value}),
                      className: "border border-gray-300 rounded-md px-3 py-2"
                    }),
                    React.createElement('input', {
                      type: "text",
                      placeholder: "הערות לפרויקט",
                      value: newProject.projectNotes,
                      onChange: (e) => setNewProject({...newProject, projectNotes: e.target.value}),
                      className: "border border-gray-300 rounded-md px-3 py-2 text-right md:col-span-2"
                    })
                  ),
                  React.createElement('div', { className: "flex justify-end space-x-reverse space-x-4 mt-4" },
                    React.createElement('button', {
                      onClick: () => setShowAddForm(false),
                      className: "px-4 py-2 text-gray-600 hover:text-gray-800"
                    }, 'ביטול'),
                    React.createElement('button', {
                      onClick: handleAddProject,
                      className: "bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700"
                    }, 'שמור')
                  )
                ),

                // Empty state or Projects Table
                projects.length === 0 ? 
                  React.createElement('div', { className: "bg-white rounded-lg shadow p-12 text-center" },
                    React.createElement(Icon, { name: "database", className: "h-16 w-16 text-gray-400 mx-auto mb-4" }),
                    React.createElement('h3', { className: "text-lg font-semibold text-gray-900 mb-2" }, 'אין פרויקטים להצגה'),
                    React.createElement('p', { className: "text-gray-600 mb-6" }, 'התחל על ידי הוספת פרויקט חדש או יייבוא נתונים מקובץ JSON'),
                    React.createElement('div', { className: "flex justify-center space-x-reverse space-x-4" },
                      React.createElement('button', {
                        onClick: () => setShowAddForm(true),
                        className: "bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 flex items-center space-x-reverse space-x-2"
                      },
                        React.createElement(Icon, { name: "plus", className: "h-5 w-5" }),
                        React.createElement('span', null, 'הוסף פרויקט ראשון')
                      ),
                      React.createElement('button', {
                        onClick: () => fileInputRef.current.click(),
                        className: "bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 flex items-center space-x-reverse space-x-2"
                      },
                        React.createElement(Icon, { name: "upload", className: "h-5 w-5" }),
                        React.createElement('span', null, 'יייבוא נתונים')
                      )
                    )
                  ) :
                  // Projects Table
                  React.createElement('div', { className: "bg-white rounded-lg shadow overflow-hidden" },
                  React.createElement('div', { className: "overflow-x-auto" },
                    React.createElement('table', { className: "min-w-full divide-y divide-gray-200" },
                      React.createElement('thead', { className: "bg-gray-50" },
                        React.createElement('tr', null,
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'תאריך הזמנה'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'שם לקוח'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'פירוט הזמנה'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'סכום עסקה'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'מע״מ (%)'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'סה״כ לתשלום'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'תקבולים'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'יתרה'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'הערות'),
                          React.createElement('th', { className: "px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider" }, 'פעולות')
                        )
                      ),
                      React.createElement('tbody', { className: "bg-white divide-y divide-gray-200" },
                        filteredProjectsForTable.map((project) => 
                          React.createElement(ProjectRow, {
                            key: project.id,
                            project: project,
                            isEditing: isEditing === project.id,
                            onEdit: () => setIsEditing(project.id),
                            onSave: (updatedProject) => handleEditProject(project.id, updatedProject),
                            onCancel: () => setIsEditing(null),
                            onDelete: () => handleDeleteProject(project.id),
                            formatCurrency: formatCurrency
                          })
                        )
                      )
                    )
                  )
                )
              )
            )
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(FinancialDashboard));
    </script>
</body>
</html>